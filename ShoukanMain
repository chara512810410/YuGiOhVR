import speech_recognition as sr
from rapidfuzz import fuzz

r = sr.Recognizer()

def find_most_similar_sentence(input_sentence, saved_sentences):
    best_match = None
    best_similarity = 0
    
    for sentence in saved_sentences:
        similarity = fuzz.ratio(input_sentence, sentence) / 100
        if similarity > best_similarity:
            best_similarity = similarity
            best_match = sentence
    
    if best_similarity == 0:
        return "存在しない"
    else:
        return best_match

# 保存している文のリスト
saved_sentences = [
   "集いし星が、新たな力を呼び起こす！光差す道となれ！シンクロ召喚！出でよ！",
    "集いし思いが、ここに新たな力となる！光差す道となれ！シンクロ召喚！燃え上がれ！",
    "集いし絆が、更なる力を紡ぎ出す！光差す道となれ！シンクロ召喚！轟け！",
    "集いし力が、大地を貫く槍となる！光差す道となれ！シンクロ召喚！砕け！",
    "集いし希望が、新たな地平へいざなう！光差す道となれ！シンクロ召喚！駆け抜けろ！",
    "集いし叫びが、木霊の矢となり空を裂く！光差す道となれ！シンクロ召喚！出でよ！",
    "集いし闘志が、怒号の魔人を呼び覚ます！光差す道となれ！シンクロ召喚！粉砕せよ！",
    "疾風の使者に鋼の願いが集う時、その願いは鉄壁の盾となる！光差す道となれ！シンクロ召喚！現れろ！",
    "集いし怒りが、忘我の戦士に鬼神を宿す！光差す道となれ！シンクロ召喚！吼えろ！",
    "集いし願いが、新たな速度の地平へいざなう！光差す道となれ！シンクロ召喚！希望の力・シンクロチューナー！",
    "集いし願いが、新たに輝く星となる！光差す道となれ！シンクロ召喚！飛翔せよ！",
    "集いし星の輝きが、新たな奇跡を照らし出す！光差す道となれ！シンクロ召喚！光来せよ！",
    "集いし夢の結晶が、新たな進化の扉を開く！光差す道となれ！アクセルシンクロ！生来せよ！",
    "集いし星が１つになる時、新たな絆が未来を照らす！光差す道となれ！リミットオーバーアクセルシンクロ！進化の光！",
    "集いし力が拳に宿り、鋼を砕く意志と化す！光差す道となれ！アクセルシンクロ！現れよ！",
    "大いなる風に導かれた翼を見よ！シンクロ召喚！響け！スターダスト・ドラゴン！",
    "王者の鼓動、今ここに列を成す！天地鳴動の力を見るがいい！シンクロ召喚！我が魂！",
    "新たなる王者の脈動、混沌の内より出でよ！シンクロ召喚！誇り高き",
    "研磨されし孤高の光、真の覇者となりて大地を照らす！光輝け！シンクロ召喚！大いなる魂！",
    "王者と悪魔、今ここに交わる！荒ぶる魂よ！天地創造の叫びを上げよ！シンクロ召喚！出でよ！",
    "王者の決断、今赤く滾る炎を宿す、真紅の刃となる！熱き波濤を超え、現れよ！シンクロ召喚！炎の騎士！",
    "赤き魂、ここに１つとなる！王者の雄叫びに震撼せよ！シンクロ召喚！現れろ！",
    "王者の咆哮、いま天地を揺るがす！唯一無二なる覇者の力を、その身に刻むがいい！シンクロ召喚！荒ぶる魂！",
    "黒き旋風よ、天空へ駆け上がる翼となれ！シンクロ召喚！",
    "漆黒の力！大いなる翼に宿りて、神風を巻き起こせ！シンクロ召喚！吹き荒べ！ブラックフェザー・アームズ・ウィング！",
    "吹き荒べ嵐よ！鋼鉄の意志と光の速さを得て、その姿を昇華せよ！シンクロ召喚！",
    "黒き疾風よ！秘めたる思いをその翼に現出せよ！シンクロ召喚！舞い上がれ！",
    "漆黒の翼ひるがえし、雷鳴と共に走れ！電光の斬撃！シンクロ召喚！降り注げ！",
    "漆黒の翼、天を穿ち飛翔せよ！シンクロ召喚！現れろ！",
    "漆黒の翼、閃光と共に天を斬れ！シンクロ召喚！現れろ！",
    "漆黒の剣、翼と共にこだませよ！シンクロ召喚！現れろ！",
    "漆黒の翼、叢雲（そううん）にひるがえし、天空を分かつ剣となれ！シンクロ召喚！降臨せよ！",
    "黒き烈風よ！絆を紡ぐ追い風となれ！シンクロ召喚！飛び立て！",
    "漆黒の翼よ、雷の力宿して鮮烈に轟け！シンクロ召喚！斬り裂け！",
    "漆黒の翼濡らし、そぼ降る雨に響け！雷鳴の一撃！シンクロ召喚！突き抜けろ！",
    "漆黒のとばり下りし時、冥府の瞳は開かれる！舞い降りろ闇よ！ダークシンクロ！出でよ！ワンハンドレッド・アイ・ドラゴン！",
    "死者と生者、ゼロにて交わりし時、永劫の檻より魔の龍は放たれる！シンクロ召喚！出でよ！インフェルニティ・デス・ドラゴン！",
    "冷たい炎が世界の全てを包み込む！漆黒の花よ…開け！シンクロ召喚！現れよ！",
    "聖なる森に潜みし、華麗なる棘の狩人よ！戒めの鞭を持ちて今こそ姿を現せ！シンクロ召喚！現れろ！",
    "世界の平和を守るため、勇気と力をドッキング！シンクロ召喚！愛と正義の使者！",
    "世界の未来を守るため、勇気と力がレボリューション！シンクロ召喚！進化せよ！",
    "聖なる守護の光、今交わりて永久の命となる！シンクロ召喚！降誕せよ！",
    "シンクロフライトコントロール！リミッター解放レベルファイブ！ブースター注入１２０％！リカバリーネットワーク・レンジ修正！オールクリア！GO！シンクロ召喚！カモン！",
    "リミッター解放レベルファイブ！ブースターランチOK！インクリネイションOK！グランドサポート！オールクリア！GO！シンクロ召喚！カモン！",
    "リミッター解放レベルファイブ！レギュレーターオープン！スラスターウォームアップOK！アップリンク！オールクリア！GO！シンクロ召喚！カモン！",
    "リミッター解放レベルツー！レギュレーターオープン！ナビゲーション！オールクリア！GO！シンクロ召喚！カモン！",
    "リミッター解放レベルテン！メインバスブースターコントロール！オールクリア！無限の力、今ここに解き放ち！次元の彼方へ突き進め！GO！アクセルシンクロ！カモン！",
    "リミッター解放レベルMAX！レギュレーターオープン！オールクリア！無限の力よ…時空を突き破り、未知なる世界を開け！GO！デルタアクセル！カモン！",
    "高速より生まれし肉体よ！革命の時は来たれり、勝利を我が手に！シンクロ召喚！煌めけ！",
    "２つの刃交わりし時、ここに忠義の刃が現れる！我に仕えよ！シンクロ召喚！現れよ！",
    "逆巻け、我が復讐の黒炎！シンクロ召喚！来い！",
    "心の深淵に燃え上がる、我が憎しみの炎よ！黒き怒濤となりてこの世界を蹂躙せよ！シンクロ召喚！現れろ！",
    "闇と闇重なりし時、冥府の扉は開かれる！光無き世界へ！ダークシンクロ！出でよ！氷結のフィッツジェラルド！",
    "暗黒より生まれし者、万物を負の世界へといざなう覇者となれ！ダークシンクロ！現れよ！猿魔王ゼーマン！",
    "暗闇の底より聞こえし慟哭よ！死神の鎧をまとい、姿を現すがいい！ダークシンクロ！現れろ！",
    "太陽昇りし時、全ての闇を照らし出す！降り注げ光よ！シンクロ召喚！出でよ！",
    "闇に月満ちる時、魔の囁きが聞こえ出す！死へといざなえ！ダークシンクロ！出でよ！",
    "狂い咲け！爆裂音！カードの荒野に戦慄のワダチを刻め！シンクロ召喚！轟け！",
    "心の闇より生まれし者…今、魂と引き換えに降臨するがいい！シンクロ召喚！脈動せよ！",
    "野性の血流交わりし時、大地を切り裂くパワーが目覚める！咆哮せよ！シンクロ召喚！大自然の力！",
    "天駆ける雷よ！猛き烈風と交わりて、幻想の世界より姿を現せ！シンクロ召喚！いななけ！",
    "天駆ける雷よ！雲海を切り裂き、そのヒヅメを地上に穿て！シンクロ召喚！轟け！",
    "天駆ける雷よ！漆黒の大気を貫き、その雷撃で大地を燃やせ！シンクロ召喚！照らせ！",
    "次元の狭間より現れし闇よ、時空を越えた舞台に破滅の幕を引け！シンクロ召喚！現れよ！",
    "星界の扉が開く時、いにしえの戦神（いくさがみ）がその魔槌（まづち）を振り上げん！大地を揺るがし轟く雷鳴と共に現れよ！シンクロ召喚！降臨せよ！",
    "星界より生まれし気まぐれなる神よ！絶対の力を我らに示し世界を笑え！シンクロ召喚！降臨せよ！",
    "北神（ほくしん）の空に在りて、全知全能を司る王よ！今こそ星界の神々を束ね、その威光を示せ！シンクロ召喚！天地神明を統べよ！最高神！",
    "揺れろ魂のペンデュラム！天空に描け光のアーク！ペンデュラム召喚！来い、俺のモンスター達！",
    "あやかしの技を操りし者、まばゆき光となりて、龍のまなこに今宿らん！融合召喚！出でよ！秘術振るいし魔天の龍！",
    "漆黒の闇より、愚鈍なる力に抗う反逆の牙！いま降臨せよ！エクシーズ召喚！",
    "二色（ふたいろ）のまなこの龍よ！その黒き逆鱗を震わせ、歯向かう敵を殲滅せよ！エクシーズ召喚！出でよ！ランク７、怒りのまなこ輝けし龍！",
    "剛毅の光を放つ勇者の剣！今ここに閃光と共に目覚めよ！シンクロ召喚！",
    "至高の天才よ、気高き共鳴よ、天使の羽ばたきよ！タクトの導きにより力重ねよ！融合召喚！今こそ舞台に情熱の歌を！",
    "雄叫び上げよ神々しき鬼よ！見参せよ悪のはびこる戰場に！シンクロ召喚！いざ出陣！",
    "荒ぶる神よ！千の刃の咆哮と共に、子供らに見守られし戦場に現れよ！シンクロ召喚！いざ出陣！",
    "動かざること連山のごとし！大岩に宿りし魂、今そびえ立つ砦となれ！シンクロ召喚！出でよ！",
    "悪魔宿りし非情の玩具よ、歯向かう愚民を根こそぎ滅ぼせ！融合召喚！現れ出ちゃえ！すべての玩具の結合魔獣！",
    "悪魔の爪よ、野獣の牙よ！神秘の渦でひとつとなりて、新たな力と姿を見せよ！融合召喚！現れ出ちゃえ！すべてを引き裂く密林の魔獣！",
    "ショー・マスト・ゴー・オン！天空の奇術師よ！華やかに舞台を駆け巡れ！エクシーズ召喚！現れろ！",
    "降り立て魔界の芸術家！エクシーズ召喚！",
    "いにしえの魂受け継ぎし、機械仕掛けの猟犬どもよ！その十の首混じり合わせ、混沌にして絶大なる力とならん！融合召喚！現れろ！",
    "雌伏の隼よ！逆境の中で研ぎ澄まされし爪を挙げ、反逆の翼ひるがえせ！エクシーズ召喚！",
    "獰猛なる隼よ！激戦を切り抜けしその翼ひるがえし、寄せ来る敵を打ち破れ！ランクアップ・エクシーズチェンジ！現れろ！",
    "誇り高き隼よ！英雄の血潮に染まる翼ひるがえし、革命の道を突き進め！ランクアップ・エクシーズチェンジ！出でよ！",
    "勇猛果敢なる隼よ！怒りの炎を巻き上げ、大地をも焼き尽くす閃光となれ！ランクアップ・エクシーズチェンジ！飛翔しろ！",
    "究極至高の隼よ！数多なる朋友の遺志を継ぎ、勝利の天空へ飛び立て！ランクアップ・エクシーズチェンジ！現れろ！",
    "蒼き闇を徘徊する猫よ、紫の毒持つ蝶よ！月の引力により渦巻きて、新たなる力と生まれ変わらん！融合召喚！現れ出でよ！月明かりに舞い踊る美しき野獣！",
    "漆黒の闇に潜む獣よ、月明かりに舞い踊る美しき野獣よ！月の引力により渦巻きて、新たなる力と生まれ変わらん！融合召喚！現れ出でよ！月光の原野で舞い踊る、しなやかなる野獣！",
    "月光の原野で舞い踊るしなやかなる野獣よ、漆黒の闇に潜む獣よ、紫の毒持つ蝶よ！月の引力により渦巻きて、新たなる力と生まれ変わらん！融合召喚！現れ出でよ！月光の原野の頂点に立って舞う百獣の王！",
    "その美しくも雄々しき翼ひるがえし、光の速さで敵を討て！シンクロ召喚！現れろ！",
    "十文字の姿もつ魔剣よ！その力ですべての敵を切り裂け！シンクロ召喚！現れろ！",
    "シンクロ召喚！その躍動感あふれる剣戟の魂！出でよ！",
    "双翼いだく、煌めくボディ！その翼で天空に跳ね上がれ！シンクロ召喚！現れろ！",
    "幾千の顔を持つ迷宮の影よ！その鋭き刃で混沌の闇を斬り裂け！シンクロ召喚！",
    "神聖なる光たくわえし翼きらめかせ、その輝きで敵を討て！シンクロ召喚！出でよ！",
    "魅惑の香りで虫を誘う、二輪の美しき花よ！今ひとつとなりて、その花弁の奥の地獄から新たな脅威を生み出せ！融合召喚！現れろ！飢えた牙持つ毒龍！",
    "鉄槌の射出機よ！我が目に宿りてその力ささげよ！融合召喚！現れろ！すべてを斬り裂く鋼の剣！",
    "焼き付けられし鉄槌の射出機よ！我が目と調和しその力ささげよ！シンクロ召喚！現れろ！すべてを撃ち抜く精巧なる銃！",
    "荘厳なる大地の覇者よ！我が目に宿りてその力ささげよ！エクシーズ召喚！現れろ！すべてを弾き返す究極武装！",
    "涙雨！光となりて降り注げ！シンクロ召喚！出でよ！",
    "その猛きこと猪のごとく！その勇壮なること鹿のごとく！その美しきこと蝶のごとく！シンクロ召喚！",
    "地獄の果てまで追い詰めよ！見よ清廉なる魂！シンクロ召喚！出でよ！",
    "荒ぶる獣の牙もて捕獲せよ！シンクロ召喚！",
    "もつれた疑惑の黒い霧切り裂き、真実を解き明かさん！シンクロ召喚！出でよ！",
    "お上の力を思い知れ！シンクロ召喚！現れろ！",
    "お上の威光の前にひれ伏すがいい！シンクロ召喚！現れろ！",
    "歪曲した煩悩をさらけ出し、茨に肉塊をゆだねよ！シンクロ召喚！現れよ！",
    "辛苦！痛み！凡庸なる価値を骸とし！すべて脱ぎ去り今、茨の道を超えよ！融合召喚！現れよ！",
    "地の底から蘇れ！戒め放つ翼持つ巨獣よ！シンクロ召喚！現れよ！",
    "地を這う囚人よ！刑場への道を歩き続ける囚人とひとつとなり、戒め与える巨獣となれ！融合召喚！現れよ！",
    "蜂出する憤激の針よ、閃光と共に天をも射抜く弓となれ！シンクロ召喚！",
    "呼応する力、怨毒の焔をたずさえ、反抗の矢を放て！シンクロ召喚！",
    "不届き者を打ち据える鉄槌の射出機！シンクロ召喚！見よ、これがお上の力だ！現れ出でよ！",
    "いにしえの魂受け継がれし、機械仕掛けの猟犬たちよ！群れなして混じり合い、新たなる力と共に生まれ変わらん！融合召喚！現れろ！",
    "牙剥く戦場の狼よ、歴戦の番兵とひとつとなりて、新たな野獣の勇者となれ！融合召喚！現れ出でよ！"
]

with sr.Microphone(device_index=0) as source:
    print('録音中: ')
    audio = r.listen(source)

try:
    # Googleの音声認識APIを使用して音声を文字に変換
    input_sentence = r.recognize_google(audio, language='ja-JP')
    print("音声を文字に変換:", input_sentence)

    # 最も一致率が高い文を見つける
    most_similar_sentence = find_most_similar_sentence(input_sentence, saved_sentences)
    print("最も一致率が高い文:", most_similar_sentence)
except sr.UnknownValueError:
    print("音声を認識できませんでした")
except sr.RequestError as e:
    print(f"Google Speech Recognition APIのリクエストでエラーが発生しました: {e}")
